{
  "best_epoch": 11,
  "best_val_macro_f1": 0.7021248843809955,
  "val_metrics": {
    "macro_f1": 0.7021248843809955,
    "micro_f1": 0.8865280289330922,
    "rare_class_f1": 0.6165452307536978,
    "per_label": {
      "diagnostic_bronchoscopy": {
        "precision": 0.9962476547842402,
        "recall": 0.9414893617021277,
        "f1": 0.968094804010939,
        "threshold": 0.30000000000000004,
        "support": 564
      },
      "bal": {
        "precision": 0.825,
        "recall": 0.9166666666666666,
        "f1": 0.868421052631579,
        "threshold": 0.7500000000000002,
        "support": 36
      },
      "bronchial_wash": {
        "precision": 0.7142857142857143,
        "recall": 1.0,
        "f1": 0.8333333333333334,
        "threshold": 0.20000000000000004,
        "support": 5
      },
      "brushings": {
        "precision": 0.631578947368421,
        "recall": 0.8888888888888888,
        "f1": 0.7384615384615385,
        "threshold": 0.45000000000000007,
        "support": 27
      },
      "endobronchial_biopsy": {
        "precision": 0.5454545454545454,
        "recall": 0.5454545454545454,
        "f1": 0.5454545454545454,
        "threshold": 0.8500000000000002,
        "support": 11
      },
      "transbronchial_biopsy": {
        "precision": 0.83125,
        "recall": 0.869281045751634,
        "f1": 0.8498402555910544,
        "threshold": 0.40000000000000013,
        "support": 153
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.7446808510638298,
        "recall": 0.7,
        "f1": 0.7216494845360825,
        "threshold": 0.6500000000000001,
        "support": 50
      },
      "tbna_conventional": {
        "precision": 0.95,
        "recall": 0.8941176470588236,
        "f1": 0.9212121212121213,
        "threshold": 0.8000000000000002,
        "support": 85
      },
      "linear_ebus": {
        "precision": 0.9425287356321839,
        "recall": 0.9265536723163842,
        "f1": 0.9344729344729344,
        "threshold": 0.6000000000000002,
        "support": 177
      },
      "radial_ebus": {
        "precision": 0.8397790055248618,
        "recall": 0.9101796407185628,
        "f1": 0.8735632183908046,
        "threshold": 0.6000000000000002,
        "support": 167
      },
      "navigational_bronchoscopy": {
        "precision": 0.6894639556377079,
        "recall": 0.9491094147582697,
        "f1": 0.7987152034261242,
        "threshold": 0.20000000000000004,
        "support": 393
      },
      "therapeutic_aspiration": {
        "precision": 0.8,
        "recall": 0.8888888888888888,
        "f1": 0.8421052631578947,
        "threshold": 0.6000000000000002,
        "support": 9
      },
      "foreign_body_removal": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.1,
        "support": 27
      },
      "airway_dilation": {
        "precision": 0.9444444444444444,
        "recall": 0.8225806451612904,
        "f1": 0.8793103448275862,
        "threshold": 0.5500000000000002,
        "support": 62
      },
      "airway_stent": {
        "precision": 0.6,
        "recall": 0.5294117647058824,
        "f1": 0.5625,
        "threshold": 0.8500000000000002,
        "support": 17
      },
      "thermal_ablation": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "cryotherapy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "mechanical_debulking": {
        "precision": 0.9873417721518988,
        "recall": 0.9629629629629629,
        "f1": 0.975,
        "threshold": 0.5500000000000002,
        "support": 81
      },
      "brachytherapy_catheter": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "blvr": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "peripheral_ablation": {
        "precision": 0.8333333333333334,
        "recall": 0.9259259259259259,
        "f1": 0.8771929824561403,
        "threshold": 0.8500000000000002,
        "support": 27
      },
      "bronchial_thermoplasty": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.45000000000000007,
        "support": 27
      },
      "whole_lung_lavage": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.1,
        "support": 9
      },
      "rigid_bronchoscopy": {
        "precision": 0.9821428571428571,
        "recall": 0.9821428571428571,
        "f1": 0.9821428571428571,
        "threshold": 0.7000000000000002,
        "support": 56
      },
      "photodynamic_therapy": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.15000000000000002,
        "support": 9
      },
      "thoracentesis": {
        "precision": 0.9354838709677419,
        "recall": 0.9354838709677419,
        "f1": 0.9354838709677419,
        "threshold": 0.8500000000000002,
        "support": 31
      },
      "chest_tube": {
        "precision": 0.8,
        "recall": 0.9655172413793104,
        "f1": 0.875,
        "threshold": 0.7500000000000002,
        "support": 29
      },
      "ipc": {
        "precision": 0.9642857142857143,
        "recall": 0.75,
        "f1": 0.84375,
        "threshold": 0.8500000000000002,
        "support": 36
      },
      "medical_thoracoscopy": {
        "precision": 0.9444444444444444,
        "recall": 0.6538461538461539,
        "f1": 0.7727272727272727,
        "threshold": 0.8000000000000002,
        "support": 26
      },
      "pleural_biopsy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 1
      },
      "pleurodesis": {
        "precision": 0.9090909090909091,
        "recall": 0.8333333333333334,
        "f1": 0.8695652173913043,
        "threshold": 0.7000000000000002,
        "support": 36
      },
      "fibrinolytic_therapy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      }
    }
  },
  "test_metrics": {
    "macro_f1": 0.7021248843809955,
    "micro_f1": 0.8865280289330922,
    "rare_class_f1": 0.6165452307536978,
    "per_label": {
      "diagnostic_bronchoscopy": {
        "precision": 0.9962476547842402,
        "recall": 0.9414893617021277,
        "f1": 0.968094804010939,
        "threshold": 0.30000000000000004,
        "support": 564
      },
      "bal": {
        "precision": 0.825,
        "recall": 0.9166666666666666,
        "f1": 0.868421052631579,
        "threshold": 0.7500000000000002,
        "support": 36
      },
      "bronchial_wash": {
        "precision": 0.7142857142857143,
        "recall": 1.0,
        "f1": 0.8333333333333334,
        "threshold": 0.20000000000000004,
        "support": 5
      },
      "brushings": {
        "precision": 0.631578947368421,
        "recall": 0.8888888888888888,
        "f1": 0.7384615384615385,
        "threshold": 0.45000000000000007,
        "support": 27
      },
      "endobronchial_biopsy": {
        "precision": 0.5454545454545454,
        "recall": 0.5454545454545454,
        "f1": 0.5454545454545454,
        "threshold": 0.8500000000000002,
        "support": 11
      },
      "transbronchial_biopsy": {
        "precision": 0.83125,
        "recall": 0.869281045751634,
        "f1": 0.8498402555910544,
        "threshold": 0.40000000000000013,
        "support": 153
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.7446808510638298,
        "recall": 0.7,
        "f1": 0.7216494845360825,
        "threshold": 0.6500000000000001,
        "support": 50
      },
      "tbna_conventional": {
        "precision": 0.95,
        "recall": 0.8941176470588236,
        "f1": 0.9212121212121213,
        "threshold": 0.8000000000000002,
        "support": 85
      },
      "linear_ebus": {
        "precision": 0.9425287356321839,
        "recall": 0.9265536723163842,
        "f1": 0.9344729344729344,
        "threshold": 0.6000000000000002,
        "support": 177
      },
      "radial_ebus": {
        "precision": 0.8397790055248618,
        "recall": 0.9101796407185628,
        "f1": 0.8735632183908046,
        "threshold": 0.6000000000000002,
        "support": 167
      },
      "navigational_bronchoscopy": {
        "precision": 0.6894639556377079,
        "recall": 0.9491094147582697,
        "f1": 0.7987152034261242,
        "threshold": 0.20000000000000004,
        "support": 393
      },
      "therapeutic_aspiration": {
        "precision": 0.8,
        "recall": 0.8888888888888888,
        "f1": 0.8421052631578947,
        "threshold": 0.6000000000000002,
        "support": 9
      },
      "foreign_body_removal": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.1,
        "support": 27
      },
      "airway_dilation": {
        "precision": 0.9444444444444444,
        "recall": 0.8225806451612904,
        "f1": 0.8793103448275862,
        "threshold": 0.5500000000000002,
        "support": 62
      },
      "airway_stent": {
        "precision": 0.6,
        "recall": 0.5294117647058824,
        "f1": 0.5625,
        "threshold": 0.8500000000000002,
        "support": 17
      },
      "thermal_ablation": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "cryotherapy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "mechanical_debulking": {
        "precision": 0.9873417721518988,
        "recall": 0.9629629629629629,
        "f1": 0.975,
        "threshold": 0.5500000000000002,
        "support": 81
      },
      "brachytherapy_catheter": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "blvr": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "peripheral_ablation": {
        "precision": 0.8333333333333334,
        "recall": 0.9259259259259259,
        "f1": 0.8771929824561403,
        "threshold": 0.8500000000000002,
        "support": 27
      },
      "bronchial_thermoplasty": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.45000000000000007,
        "support": 27
      },
      "whole_lung_lavage": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.1,
        "support": 9
      },
      "rigid_bronchoscopy": {
        "precision": 0.9821428571428571,
        "recall": 0.9821428571428571,
        "f1": 0.9821428571428571,
        "threshold": 0.7000000000000002,
        "support": 56
      },
      "photodynamic_therapy": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.15000000000000002,
        "support": 9
      },
      "thoracentesis": {
        "precision": 0.9354838709677419,
        "recall": 0.9354838709677419,
        "f1": 0.9354838709677419,
        "threshold": 0.8500000000000002,
        "support": 31
      },
      "chest_tube": {
        "precision": 0.8,
        "recall": 0.9655172413793104,
        "f1": 0.875,
        "threshold": 0.7500000000000002,
        "support": 29
      },
      "ipc": {
        "precision": 0.9642857142857143,
        "recall": 0.75,
        "f1": 0.84375,
        "threshold": 0.8500000000000002,
        "support": 36
      },
      "medical_thoracoscopy": {
        "precision": 0.9444444444444444,
        "recall": 0.6538461538461539,
        "f1": 0.7727272727272727,
        "threshold": 0.8000000000000002,
        "support": 26
      },
      "pleural_biopsy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 1
      },
      "pleurodesis": {
        "precision": 0.9090909090909091,
        "recall": 0.8333333333333334,
        "f1": 0.8695652173913043,
        "threshold": 0.7000000000000002,
        "support": 36
      },
      "fibrinolytic_therapy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      }
    }
  },
  "config": {
    "student_model": "microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext",
    "teacher_probs": "data/models/distill/teacher_probs.npy",
    "labels_json": "data/ml_training/cleaned_v4/registry_label_fields.json",
    "train_csv": "data/ml_training/cleaned_v4/registry_train_clean.csv",
    "output_dir": "data/models/distill_runs/pm3_lr2e5_e12_a0.3_t2.0",
    "batch_size": 16,
    "num_epochs": 12,
    "learning_rate": 2e-05,
    "warmup_ratio": 0.1,
    "weight_decay": 0.01,
    "gradient_accumulation_steps": 1,
    "max_grad_norm": 1.0,
    "val_split": 0.1,
    "fp16": true,
    "max_length": 512,
    "head_tokens": 382,
    "tail_tokens": 128,
    "pos_weight_cap": 100.0,
    "temperature": 2.0,
    "alpha": 0.3,
    "device": "cuda",
    "s3_bucket": "procedure-suite-models",
    "save_every": 1,
    "seed": 42,
    "resume_from": null,
    "evaluate_only": false,
    "skip_s3_sync": false,
    "log_file": "data/models/distill_runs/pm3_lr2e5_e12_a0.3_t2.0/run.log"
  }
}