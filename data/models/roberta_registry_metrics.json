{
  "best_epoch": 4,
  "best_val_macro_f1": 0.822416449744651,
  "test_metrics": {
    "macro_f1": 0.7757215500777903,
    "micro_f1": 0.8479252661307842,
    "rare_class_f1": 0.6768004132656646,
    "per_label": {
      "diagnostic_bronchoscopy": {
        "precision": 0.9330434782608695,
        "recall": 0.9412280701754386,
        "f1": 0.9371179039301311,
        "threshold": 0.40000000000000013,
        "support": 1140
      },
      "bal": {
        "precision": 0.8476190476190476,
        "recall": 0.7876106194690266,
        "f1": 0.8165137614678899,
        "threshold": 0.8000000000000002,
        "support": 113
      },
      "bronchial_wash": {
        "precision": 0.3076923076923077,
        "recall": 0.42105263157894735,
        "f1": 0.35555555555555557,
        "threshold": 0.8000000000000002,
        "support": 19
      },
      "brushings": {
        "precision": 0.7418181818181818,
        "recall": 0.8535564853556485,
        "f1": 0.7937743190661478,
        "threshold": 0.7000000000000002,
        "support": 239
      },
      "endobronchial_biopsy": {
        "precision": 0.5858585858585859,
        "recall": 0.8787878787878788,
        "f1": 0.703030303030303,
        "threshold": 0.6500000000000001,
        "support": 66
      },
      "tbna_conventional": {
        "precision": 0.6666666666666666,
        "recall": 0.7064220183486238,
        "f1": 0.6859688195991092,
        "threshold": 0.6500000000000001,
        "support": 218
      },
      "linear_ebus": {
        "precision": 0.9311475409836065,
        "recall": 0.8958990536277602,
        "f1": 0.9131832797427653,
        "threshold": 0.6500000000000001,
        "support": 317
      },
      "radial_ebus": {
        "precision": 0.8613861386138614,
        "recall": 0.9157894736842105,
        "f1": 0.8877551020408163,
        "threshold": 0.6500000000000001,
        "support": 380
      },
      "navigational_bronchoscopy": {
        "precision": 0.7995594713656388,
        "recall": 0.9758064516129032,
        "f1": 0.8789346246973365,
        "threshold": 0.5000000000000001,
        "support": 372
      },
      "transbronchial_biopsy": {
        "precision": 0.7475961538461539,
        "recall": 0.8567493112947658,
        "f1": 0.7984595635430038,
        "threshold": 0.6000000000000002,
        "support": 363
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.7789473684210526,
        "recall": 0.8604651162790697,
        "f1": 0.8176795580110497,
        "threshold": 0.8500000000000002,
        "support": 86
      },
      "therapeutic_aspiration": {
        "precision": 0.75,
        "recall": 0.8333333333333334,
        "f1": 0.7894736842105263,
        "threshold": 0.7500000000000002,
        "support": 72
      },
      "foreign_body_removal": {
        "precision": 0.717391304347826,
        "recall": 0.9428571428571428,
        "f1": 0.8148148148148148,
        "threshold": 0.8000000000000002,
        "support": 35
      },
      "airway_dilation": {
        "precision": 0.7619047619047619,
        "recall": 0.7164179104477612,
        "f1": 0.7384615384615385,
        "threshold": 0.7500000000000002,
        "support": 67
      },
      "airway_stent": {
        "precision": 0.8487394957983193,
        "recall": 0.9099099099099099,
        "f1": 0.8782608695652174,
        "threshold": 0.8500000000000002,
        "support": 111
      },
      "thermal_ablation": {
        "precision": 0.7735849056603774,
        "recall": 0.6890756302521008,
        "f1": 0.7288888888888889,
        "threshold": 0.8000000000000002,
        "support": 119
      },
      "cryotherapy": {
        "precision": 0.62,
        "recall": 0.8857142857142857,
        "f1": 0.7294117647058823,
        "threshold": 0.8000000000000002,
        "support": 35
      },
      "blvr": {
        "precision": 0.8805970149253731,
        "recall": 0.9516129032258065,
        "f1": 0.9147286821705426,
        "threshold": 0.7500000000000002,
        "support": 62
      },
      "peripheral_ablation": {
        "precision": 0.6506024096385542,
        "recall": 0.6923076923076923,
        "f1": 0.6708074534161491,
        "threshold": 0.7500000000000002,
        "support": 78
      },
      "bronchial_thermoplasty": {
        "precision": 0.8888888888888888,
        "recall": 1.0,
        "f1": 0.9411764705882353,
        "threshold": 0.5000000000000001,
        "support": 24
      },
      "whole_lung_lavage": {
        "precision": 0.9375,
        "recall": 0.9375,
        "f1": 0.9375,
        "threshold": 0.5000000000000001,
        "support": 16
      },
      "rigid_bronchoscopy": {
        "precision": 0.7302631578947368,
        "recall": 0.7254901960784313,
        "f1": 0.7278688524590164,
        "threshold": 0.8500000000000002,
        "support": 153
      },
      "thoracentesis": {
        "precision": 0.6296296296296297,
        "recall": 0.8717948717948718,
        "f1": 0.7311827956989247,
        "threshold": 0.7000000000000002,
        "support": 39
      },
      "chest_tube": {
        "precision": 0.8620689655172413,
        "recall": 0.78125,
        "f1": 0.819672131147541,
        "threshold": 0.8500000000000002,
        "support": 64
      },
      "ipc": {
        "precision": 0.7894736842105263,
        "recall": 0.8653846153846154,
        "f1": 0.8256880733944955,
        "threshold": 0.8000000000000002,
        "support": 52
      },
      "medical_thoracoscopy": {
        "precision": 0.8709677419354839,
        "recall": 0.9642857142857143,
        "f1": 0.9152542372881356,
        "threshold": 0.7000000000000002,
        "support": 112
      },
      "pleurodesis": {
        "precision": 0.8076923076923077,
        "recall": 0.875,
        "f1": 0.84,
        "threshold": 0.8500000000000002,
        "support": 72
      },
      "pleural_biopsy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.45000000000000007,
        "support": 0
      },
      "fibrinolytic_therapy": {
        "precision": 0.8260869565217391,
        "recall": 1.0,
        "f1": 0.9047619047619048,
        "threshold": 0.8500000000000002,
        "support": 19
      }
    }
  },
  "config": {
    "model_name": "microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext",
    "batch_size": 16,
    "learning_rate": 2e-05,
    "num_epochs": 5,
    "max_length": 512,
    "head_tokens": 382,
    "tail_tokens": 128
  }
}