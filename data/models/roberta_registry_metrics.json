{
  "best_epoch": 4,
  "best_val_macro_f1": 0.7809686787924178,
  "test_metrics": {
    "macro_f1": 0.7842603277006523,
    "micro_f1": 0.8494290897449579,
    "rare_class_f1": 0.7380799592564299,
    "per_label": {
      "diagnostic_bronchoscopy": {
        "precision": 0.9293712316968131,
        "recall": 0.9514991181657848,
        "f1": 0.9403050108932461,
        "threshold": 0.3500000000000001,
        "support": 1134
      },
      "bal": {
        "precision": 0.7692307692307693,
        "recall": 0.8928571428571429,
        "f1": 0.8264462809917356,
        "threshold": 0.7000000000000002,
        "support": 112
      },
      "bronchial_wash": {
        "precision": 0.25,
        "recall": 0.5,
        "f1": 0.3333333333333333,
        "threshold": 0.8000000000000002,
        "support": 18
      },
      "brushings": {
        "precision": 0.8613445378151261,
        "recall": 0.8613445378151261,
        "f1": 0.8613445378151261,
        "threshold": 0.8000000000000002,
        "support": 238
      },
      "endobronchial_biopsy": {
        "precision": 0.6052631578947368,
        "recall": 0.6865671641791045,
        "f1": 0.6433566433566433,
        "threshold": 0.6500000000000001,
        "support": 67
      },
      "tbna_conventional": {
        "precision": 0.6747572815533981,
        "recall": 0.6847290640394089,
        "f1": 0.6797066014669927,
        "threshold": 0.7500000000000002,
        "support": 203
      },
      "linear_ebus": {
        "precision": 0.9348534201954397,
        "recall": 0.9025157232704403,
        "f1": 0.9184,
        "threshold": 0.6500000000000001,
        "support": 318
      },
      "radial_ebus": {
        "precision": 0.8656716417910447,
        "recall": 0.9182058047493403,
        "f1": 0.8911651728553137,
        "threshold": 0.6500000000000001,
        "support": 379
      },
      "navigational_bronchoscopy": {
        "precision": 0.821917808219178,
        "recall": 0.967741935483871,
        "f1": 0.8888888888888888,
        "threshold": 0.6000000000000002,
        "support": 372
      },
      "transbronchial_biopsy": {
        "precision": 0.7651715039577837,
        "recall": 0.8011049723756906,
        "f1": 0.7827260458839406,
        "threshold": 0.6500000000000001,
        "support": 362
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.7083333333333334,
        "recall": 0.6891891891891891,
        "f1": 0.6986301369863014,
        "threshold": 0.8500000000000002,
        "support": 74
      },
      "therapeutic_aspiration": {
        "precision": 0.746268656716418,
        "recall": 0.6944444444444444,
        "f1": 0.7194244604316546,
        "threshold": 0.8500000000000002,
        "support": 72
      },
      "foreign_body_removal": {
        "precision": 0.8048780487804879,
        "recall": 0.9166666666666666,
        "f1": 0.8571428571428571,
        "threshold": 0.7500000000000002,
        "support": 36
      },
      "airway_dilation": {
        "precision": 0.9130434782608695,
        "recall": 0.6,
        "f1": 0.7241379310344828,
        "threshold": 0.8500000000000002,
        "support": 70
      },
      "airway_stent": {
        "precision": 0.7769784172661871,
        "recall": 0.972972972972973,
        "f1": 0.864,
        "threshold": 0.8000000000000002,
        "support": 111
      },
      "thermal_ablation": {
        "precision": 0.7066666666666667,
        "recall": 0.8760330578512396,
        "f1": 0.7822878228782287,
        "threshold": 0.7500000000000002,
        "support": 121
      },
      "tumor_debulking_non_thermal": {
        "precision": 0.5057471264367817,
        "recall": 0.7213114754098361,
        "f1": 0.5945945945945946,
        "threshold": 0.8500000000000002,
        "support": 61
      },
      "cryotherapy": {
        "precision": 0.6530612244897959,
        "recall": 0.8888888888888888,
        "f1": 0.7529411764705882,
        "threshold": 0.8500000000000002,
        "support": 36
      },
      "blvr": {
        "precision": 0.8732394366197183,
        "recall": 1.0,
        "f1": 0.9323308270676691,
        "threshold": 0.7500000000000002,
        "support": 62
      },
      "peripheral_ablation": {
        "precision": 0.7126436781609196,
        "recall": 0.8157894736842105,
        "f1": 0.7607361963190185,
        "threshold": 0.8500000000000002,
        "support": 76
      },
      "bronchial_thermoplasty": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.5500000000000002,
        "support": 24
      },
      "whole_lung_lavage": {
        "precision": 0.8823529411764706,
        "recall": 0.9375,
        "f1": 0.9090909090909091,
        "threshold": 0.5500000000000002,
        "support": 16
      },
      "rigid_bronchoscopy": {
        "precision": 0.6045454545454545,
        "recall": 0.875,
        "f1": 0.7150537634408602,
        "threshold": 0.7500000000000002,
        "support": 152
      },
      "thoracentesis": {
        "precision": 0.7608695652173914,
        "recall": 0.8974358974358975,
        "f1": 0.8235294117647058,
        "threshold": 0.8500000000000002,
        "support": 39
      },
      "chest_tube": {
        "precision": 0.864406779661017,
        "recall": 0.796875,
        "f1": 0.8292682926829268,
        "threshold": 0.8000000000000002,
        "support": 64
      },
      "ipc": {
        "precision": 0.8363636363636363,
        "recall": 0.8846153846153846,
        "f1": 0.8598130841121495,
        "threshold": 0.8500000000000002,
        "support": 52
      },
      "medical_thoracoscopy": {
        "precision": 0.8455284552845529,
        "recall": 0.9285714285714286,
        "f1": 0.8851063829787233,
        "threshold": 0.6500000000000001,
        "support": 112
      },
      "pleurodesis": {
        "precision": 0.9178082191780822,
        "recall": 0.9178082191780822,
        "f1": 0.9178082191780822,
        "threshold": 0.8500000000000002,
        "support": 73
      },
      "pleural_biopsy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 1
      },
      "fibrinolytic_therapy": {
        "precision": 0.8260869565217391,
        "recall": 1.0,
        "f1": 0.9047619047619048,
        "threshold": 0.7500000000000002,
        "support": 19
      },
      "percutaneous_tracheostomy": {
        "precision": 0.6666666666666666,
        "recall": 1.0,
        "f1": 0.8,
        "threshold": 0.40000000000000013,
        "support": 18
      },
      "peg_insertion": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.8500000000000002,
        "support": 15
      }
    }
  },
  "config": {
    "model_name": "microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext",
    "batch_size": 16,
    "learning_rate": 2e-05,
    "num_epochs": 5,
    "max_length": 512,
    "head_tokens": 382,
    "tail_tokens": 128
  }
}