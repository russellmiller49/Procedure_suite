{
  "best_epoch": 3,
  "best_val_macro_f1": 0.6707002064894428,
  "test_metrics": {
    "macro_f1": 0.6845625034126461,
    "micro_f1": 0.8482772516623011,
    "rare_class_f1": 0.5555676706015733,
    "per_label": {
      "airway_dilation": {
        "precision": 0.6133333333333333,
        "recall": 1.0,
        "f1": 0.7603305785123967,
        "threshold": 0.1,
        "support": 92
      },
      "airway_stent": {
        "precision": 0.8,
        "recall": 1.0,
        "f1": 0.8888888888888888,
        "threshold": 0.8500000000000002,
        "support": 12
      },
      "bal": {
        "precision": 0.8888888888888888,
        "recall": 0.96,
        "f1": 0.9230769230769231,
        "threshold": 0.5500000000000002,
        "support": 50
      },
      "blvr": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.7000000000000002,
        "support": 2
      },
      "brachytherapy_catheter": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "bronchial_thermoplasty": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.7000000000000002,
        "support": 1
      },
      "brushings": {
        "precision": 0.7794871794871795,
        "recall": 0.9382716049382716,
        "f1": 0.8515406162464986,
        "threshold": 0.6000000000000002,
        "support": 162
      },
      "chest_tube": {
        "precision": 0.17346938775510204,
        "recall": 0.9444444444444444,
        "f1": 0.29310344827586204,
        "threshold": 0.6000000000000002,
        "support": 18
      },
      "cryotherapy": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.7000000000000002,
        "support": 27
      },
      "diagnostic_bronchoscopy": {
        "precision": 0.9321148825065274,
        "recall": 0.9972067039106145,
        "f1": 0.9635627530364372,
        "threshold": 0.25000000000000006,
        "support": 358
      },
      "endobronchial_biopsy": {
        "precision": 0.3333333333333333,
        "recall": 1.0,
        "f1": 0.5,
        "threshold": 0.8500000000000002,
        "support": 1
      },
      "fibrinolytic_therapy": {
        "precision": 0.9565217391304348,
        "recall": 0.9777777777777777,
        "f1": 0.967032967032967,
        "threshold": 0.45000000000000007,
        "support": 45
      },
      "foreign_body_removal": {
        "precision": 1.0,
        "recall": 0.9666666666666667,
        "f1": 0.9830508474576272,
        "threshold": 0.8500000000000002,
        "support": 30
      },
      "ipc": {
        "precision": 0.21,
        "recall": 1.0,
        "f1": 0.34710743801652894,
        "threshold": 0.8500000000000002,
        "support": 21
      },
      "linear_ebus": {
        "precision": 0.45652173913043476,
        "recall": 1.0,
        "f1": 0.6268656716417911,
        "threshold": 0.5000000000000001,
        "support": 21
      },
      "mechanical_debulking": {
        "precision": 0.13333333333333333,
        "recall": 0.6666666666666666,
        "f1": 0.2222222222222222,
        "threshold": 0.7000000000000002,
        "support": 3
      },
      "medical_thoracoscopy": {
        "precision": 0.8461538461538461,
        "recall": 0.9705882352941176,
        "f1": 0.9041095890410958,
        "threshold": 0.5,
        "support": 136
      },
      "navigational_bronchoscopy": {
        "precision": 0.9876160990712074,
        "recall": 0.9815384615384616,
        "f1": 0.9845679012345679,
        "threshold": 0.45000000000000007,
        "support": 325
      },
      "peripheral_ablation": {
        "precision": 0.963855421686747,
        "recall": 0.9876543209876543,
        "f1": 0.975609756097561,
        "threshold": 0.3500000000000001,
        "support": 81
      },
      "pleural_biopsy": {
        "precision": 0.008,
        "recall": 1.0,
        "f1": 0.015873015873015872,
        "threshold": 0.5,
        "support": 1
      },
      "pleurodesis": {
        "precision": 0.9782608695652174,
        "recall": 0.9926470588235294,
        "f1": 0.9854014598540146,
        "threshold": 0.40000000000000013,
        "support": 136
      },
      "radial_ebus": {
        "precision": 0.9876543209876543,
        "recall": 0.9846153846153847,
        "f1": 0.9861325115562404,
        "threshold": 0.5000000000000001,
        "support": 325
      },
      "rigid_bronchoscopy": {
        "precision": 0.5476190476190477,
        "recall": 1.0,
        "f1": 0.7076923076923077,
        "threshold": 0.6500000000000001,
        "support": 23
      },
      "tbna_conventional": {
        "precision": 0.7368421052631579,
        "recall": 0.98,
        "f1": 0.8412017167381974,
        "threshold": 0.8000000000000002,
        "support": 100
      },
      "therapeutic_aspiration": {
        "precision": 0.09090909090909091,
        "recall": 1.0,
        "f1": 0.16666666666666666,
        "threshold": 0.5000000000000001,
        "support": 1
      },
      "thermal_ablation": {
        "precision": 0.8,
        "recall": 1.0,
        "f1": 0.8888888888888888,
        "threshold": 0.5500000000000002,
        "support": 12
      },
      "thoracentesis": {
        "precision": 0.012987012987012988,
        "recall": 0.5,
        "f1": 0.02531645569620253,
        "threshold": 0.8500000000000002,
        "support": 2
      },
      "transbronchial_biopsy": {
        "precision": 0.9539473684210527,
        "recall": 0.6971153846153846,
        "f1": 0.8055555555555556,
        "threshold": 0.8000000000000002,
        "support": 208
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.9230769230769231,
        "recall": 0.9230769230769231,
        "f1": 0.9230769230769231,
        "threshold": 0.7500000000000002,
        "support": 13
      },
      "whole_lung_lavage": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.8000000000000002,
        "support": 0
      }
    }
  },
  "config": {
    "model_name": "data/models/RoBERTa-base-PM-M3-Voc-distill/RoBERTa-base-PM-M3-Voc-distill-hf",
    "batch_size": 16,
    "learning_rate": 2e-05,
    "num_epochs": 5,
    "max_length": 512,
    "head_tokens": 382,
    "tail_tokens": 128
  }
}