{
  "best_epoch": 5,
  "best_val_macro_f1": 0.8032994076051551,
  "test_metrics": {
    "macro_f1": 0.7723913019517461,
    "micro_f1": 0.9123347219706575,
    "rare_class_f1": 0.5737311502086809,
    "per_label": {
      "airway_dilation": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.8500000000000002,
        "support": 0
      },
      "airway_stent": {
        "precision": 0.944954128440367,
        "recall": 0.7518248175182481,
        "f1": 0.8373983739837398,
        "threshold": 0.7500000000000002,
        "support": 137
      },
      "bal": {
        "precision": 0.9166666666666666,
        "recall": 0.9166666666666666,
        "f1": 0.9166666666666666,
        "threshold": 0.8500000000000002,
        "support": 132
      },
      "blvr": {
        "precision": 0.9529411764705882,
        "recall": 1.0,
        "f1": 0.9759036144578314,
        "threshold": 0.8500000000000002,
        "support": 81
      },
      "brachytherapy_catheter": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.45000000000000007,
        "support": 0
      },
      "bronchial_thermoplasty": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.5500000000000002,
        "support": 29
      },
      "bronchial_wash": {
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "threshold": 0.8500000000000002,
        "support": 2
      },
      "brushings": {
        "precision": 0.9210526315789473,
        "recall": 0.9271523178807947,
        "f1": 0.9240924092409241,
        "threshold": 0.8500000000000002,
        "support": 151
      },
      "chest_tube": {
        "precision": 0.9668874172185431,
        "recall": 0.9931972789115646,
        "f1": 0.9798657718120806,
        "threshold": 0.8000000000000002,
        "support": 147
      },
      "cryotherapy": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "diagnostic_bronchoscopy": {
        "precision": 0.9569179784589892,
        "recall": 0.953757225433526,
        "f1": 0.9553349875930521,
        "threshold": 0.15000000000000002,
        "support": 1211
      },
      "endobronchial_biopsy": {
        "precision": 0.8939393939393939,
        "recall": 1.0,
        "f1": 0.944,
        "threshold": 0.8500000000000002,
        "support": 59
      },
      "fibrinolytic_therapy": {
        "precision": 0.9166666666666666,
        "recall": 1.0,
        "f1": 0.9565217391304348,
        "threshold": 0.45000000000000007,
        "support": 11
      },
      "foreign_body_removal": {
        "precision": 0.8,
        "recall": 1.0,
        "f1": 0.8888888888888888,
        "threshold": 0.40000000000000013,
        "support": 40
      },
      "ipc": {
        "precision": 0.95,
        "recall": 0.9047619047619048,
        "f1": 0.926829268292683,
        "threshold": 0.8000000000000002,
        "support": 63
      },
      "linear_ebus": {
        "precision": 0.9318885448916409,
        "recall": 0.9525316455696202,
        "f1": 0.9420970266040689,
        "threshold": 0.5500000000000002,
        "support": 316
      },
      "mechanical_debulking": {
        "precision": 0.9806949806949807,
        "recall": 0.951310861423221,
        "f1": 0.9657794676806084,
        "threshold": 0.7500000000000002,
        "support": 267
      },
      "medical_thoracoscopy": {
        "precision": 0.9166666666666666,
        "recall": 0.9230769230769231,
        "f1": 0.9198606271777003,
        "threshold": 0.7500000000000002,
        "support": 143
      },
      "navigational_bronchoscopy": {
        "precision": 0.7137064071370641,
        "recall": 0.963855421686747,
        "f1": 0.8201304753028891,
        "threshold": 0.25000000000000006,
        "support": 913
      },
      "peripheral_ablation": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "photodynamic_therapy": {
        "precision": 0.9,
        "recall": 1.0,
        "f1": 0.9473684210526315,
        "threshold": 0.7500000000000002,
        "support": 9
      },
      "pleural_biopsy": {
        "precision": 0.7228915662650602,
        "recall": 0.967741935483871,
        "f1": 0.8275862068965517,
        "threshold": 0.8500000000000002,
        "support": 62
      },
      "pleurodesis": {
        "precision": 0.9910714285714286,
        "recall": 0.9568965517241379,
        "f1": 0.9736842105263158,
        "threshold": 0.6500000000000001,
        "support": 116
      },
      "radial_ebus": {
        "precision": 0.9581497797356828,
        "recall": 0.9477124183006536,
        "f1": 0.9529025191675794,
        "threshold": 0.8000000000000002,
        "support": 459
      },
      "rigid_bronchoscopy": {
        "precision": 0.9247311827956989,
        "recall": 0.9942196531791907,
        "f1": 0.958217270194986,
        "threshold": 0.8000000000000002,
        "support": 173
      },
      "tbna_conventional": {
        "precision": 0.972809667673716,
        "recall": 0.9611940298507463,
        "f1": 0.9669669669669669,
        "threshold": 0.7000000000000002,
        "support": 335
      },
      "therapeutic_aspiration": {
        "precision": 0.6785714285714286,
        "recall": 0.8636363636363636,
        "f1": 0.76,
        "threshold": 0.7500000000000002,
        "support": 22
      },
      "thermal_ablation": {
        "precision": 0.0,
        "recall": 0.0,
        "f1": 0.0,
        "threshold": 0.5,
        "support": 0
      },
      "thoracentesis": {
        "precision": 0.8103448275862069,
        "recall": 0.9591836734693877,
        "f1": 0.8785046728971962,
        "threshold": 0.8500000000000002,
        "support": 49
      },
      "transbronchial_biopsy": {
        "precision": 0.8680351906158358,
        "recall": 0.9278996865203761,
        "f1": 0.896969696969697,
        "threshold": 0.7500000000000002,
        "support": 319
      },
      "transbronchial_cryobiopsy": {
        "precision": 0.8222222222222222,
        "recall": 0.9487179487179487,
        "f1": 0.8809523809523809,
        "threshold": 0.8000000000000002,
        "support": 39
      },
      "whole_lung_lavage": {
        "precision": 0.5625,
        "recall": 1.0,
        "f1": 0.72,
        "threshold": 0.3500000000000001,
        "support": 18
      }
    }
  },
  "config": {
    "model_name": "data/models/RoBERTa-base-PM-M3-Voc-distill/RoBERTa-base-PM-M3-Voc-distill-hf",
    "batch_size": 16,
    "learning_rate": 2e-05,
    "num_epochs": 5,
    "max_length": 512,
    "head_tokens": 382,
    "tail_tokens": 128
  }
}